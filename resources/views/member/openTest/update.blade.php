@extends('public.base')

@section('title','用户中心-游戏开测榜')

@section('uc_here', '游戏开测榜')

@section('css')
    <!-- 引入本组公共样式 -->
    <link rel="stylesheet" href="/dist/css/personal/personal.css">
    <!-- 引入本页独立样式 -->
    <link rel="stylesheet" href="/dist/css/personal/research.css">
    <link rel="stylesheet" href="/plugins/jedate/skin/jedate.css">
@endsection

@section('content')
    @include('public.member_header')
    <!-- 内容部分 -->
    <div class="wrapper">
        @include('public.member_left')
        <div class="right-content">
            <form id="right-wrapper" action="{{ route('member.publishing.openTest.store') }}" method="post">
                <input value="{{ $data->id }}" type="hidden" name="id">
                {{csrf_field()}}
                @include('public.member_top')
                <div class="one-demand-content">
                    <div class="one-demand-name">
                        测试时间
                    </div>
                    <div class="one-demand relative">
                        <input type="text" id="indate" class="inputlist" name="open_time" value="{{ $data->open_time }}" placeholder="请输入测试时间">
                    </div>
                </div>
                <div class="one-demand-content">
                    <div class="one-demand-name">
                        游戏名称
                    </div>
                    <div class="one-demand relative">
                        <input type="text" id="product-name" placeholder="例如：剑灵" value="{{ $data->productInfo->title }}" />
                        <input type="hidden" id="product-id" name="product_id"/>
                        <div id="product-name-items">
                            请选择产品
                        </div>
                        <div class="product-name-content">
                            <span class="top-arrow"></span>
                            @foreach($products as $product)
                                <span class="one-product-name" data-index="{{ $product->id }}">{{$product->title}}</span>
                            @endforeach
                        </div>
                    </div>
                </div>
                <div class="one-demand-content">
                    <div class="one-demand-name">
                        游戏类型
                    </div>
                    <div class="one-demand relative">
                        <div class="game_type">{{ $product_config['game_type'][$data->productInfo->game_type_id] }} - {{ $product_config['type'][$data->productInfo->type_id] }}</div>
                    </div>
                </div>
                <div class="one-demand-content">
                    <div class="one-demand-name">
                        测试进度
                    </div>
                    <div class="one-demand relative">
                        @foreach($product_config['schedule'] as $key => $v)
                            <input type="radio" name="schedule_id" @if($data->schedule_id == $key) checked @endif value="{{$key}}">{{ $v }}
                        @endforeach
                    </div>
                </div>
                <div class="one-demand-content">
                    <div class="one-demand-name">
                        是否删档
                    </div>
                    <div class="one-demand relative">
                        <input type="radio" name="is_del" @if($data->is_del == 1) checked @endif value="1">删档
                        <input type="radio" name="is_del" @if($data->is_del == 0) checked @endif value="0">不删档
                    </div>
                </div>
                <div class="one-demand-content">
                    <div class="one-demand-name">
                        是否计费
                    </div>
                    <div class="one-demand relative">
                        <input type="radio" name="is_billing" @if($data->is_billing == 1) checked @endif value="1" value="1">计费
                        <input type="radio" name="is_billing" @if($data->is_billing == 0) checked @endif value="1" value="0">不计费
                    </div>
                </div>
                <div class="one-demand-content">
                    <div class="one-demand-name">
                        测试平台
                    </div>
                    <div class="one-demand relative">
                        @foreach($product_config['platform'] as $key => $v)
                            <input type="checkbox" name="platform_id[]" @if(in_array($key, explode(',', $data->platform_id))) checked @endif value="{{$key}}">{{ $v }}
                        @endforeach
                    </div>
                </div>
                <div class="one-demand-content">
                    <div class="one-demand-name">
                        研发方
                    </div>
                    <div class="one-demand relative">
                        <input type="text" class="inputlist" name="research" value="{{$data->research}}" placeholder="请输入研发公司">
                    </div>
                </div>
                <div class="one-demand-content">
                    <div class="one-demand-name">
                        发行方
                    </div>
                    <div class="one-demand relative">
                        <input type="text" class="inputlist" name="issue" value="{{$data->issue}}" placeholder="请输入发行公司">
                    </div>
                </div>
                <input type="submit" value="发布" id="releasebtn" style="margin: 30px auto;">
            </form>
        </div>
    </div>
    </div>
@endsection

@section('js')
    <script src="/dist/js/personal/research.js"></script>
    <script src="/plugins/jedate/jquery.jedate.min.js"></script>
    <script>
        $(document).ready(function() {
            $("#indate").jeDate({
                format:"YYYY.MM.DD",
                isTime:false,
                minDate:"2014.09.19 00:00:00"
            })
            // 产品选择
            $(".one-product-name").click(function() {
                $("#product-name").val($(this).html().trim())
                $("#product-id").val($(this).data('index'))
                $(this).parent().css({display: "none"}).prev().css({color: "#646464"})
                $.ajax({
                    url:"{{ route('member.publishing.openTest.productInfo') }}",
                    type:'POST',
                    dataTpye:'json',
                    data:{"id" : $(this).data('index'), '_token' : "{{csrf_token()}}"},
                    success : function(data) {
                        if (data.code == 0) {
                            $('.game_type').html(data.message.game_type + "-" + data.message.type)
                        } else {
                            toastr.options = {"positionClass":"toast-top-center"};
                            toastr.error(data.message,'');
                        }
                    }
                })
            })
        })
    </script>
@endsection